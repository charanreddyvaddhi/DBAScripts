SELECT
 AT.TRANSACTION_ID,
 ΑΤ.ΝΑΜΕ,
 AT.TRANSACTION_BEGIN_TIME,
 DATEDIFF(SECOND, AT.TRANSACTION_BEGIN_TIME, GETDATE()) AS TRANSACTION_DURATION_SECONDS,
 S.SESSION_ID,
 S.LOGIN_NAME,
 ISNULL(R.STATUS, 'N/A') AS STATUS,
 ISNULL(R.COMMAND, 'N/A') AS COMMAND,
 ISNULL(R.WAIT_TYPE, 'N/A') AS WAIT_TYPE,
 ISNULL(R.WAIT_TIME, 0) AS WAIT_TIME,
 ISNULL(R.BLOCKING_SESSION_ID, 0) AS BLOCKING_SESSION_ID,
 ISNULL(R.LAST_WAIT_TYPE, 'N/A') AS LAST_WAIT_TYPE,
 ISNULL(R.WAIT_RESOURCE, 'N/A') AS WAIT_RESOURCE,
 ISNULL(T.TEXT, 'N/A') AS SQL_TEXT
FROM SYS.DM_TRAN_ACTIVE_TRANSACTIONS AT
 LEFT JOIN SYS.DM_EXEC_REQUESTS R ON AT.TRANSACTION_ID = R.TRANSACTION_ID
 LEFT JOIN SYS.DM_EXEC_SESSIONS S ON R.SESSION_ID = S.SESSION_ID
 OUTER APPLY SYS.DM_EXEC_SQL_TEXT(R.SQL_HANDLE) AS T
ORDER BY TRANSACTION_DURATION_SECONDS DESC;